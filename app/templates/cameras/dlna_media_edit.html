{% extends 'base.html' %}

{% block title %}DLNA Media Â· PentaVision{% endblock %}

{% block content %}
  <section class="pv-section">
    <div class="pv-admin-layout">
      {% include 'admin/_nav.html' %}
      <div class="pv-admin-main">
        <div class="pv-page-header">
          <div>
            <h1 class="pv-page-title">DLNA Media</h1>
            <p class="pv-page-subtitle">Configure whether a camera is exposed as a near-live DLNA media item.</p>
          </div>
          <div class="pv-page-actions">
            <a href="{{ url_for('camera_admin.dlna_media_list') }}" class="pv-button-secondary">Back</a>
          </div>
        </div>

    {% if errors %}
      <div class="pv-alert pv-alert-error">
        <ul>
          {% for error in errors %}
            <li>{{ error }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if not device %}
      <div class="pv-empty">
        <img
          class="pv-empty-icon"
          src="{{ url_for('static', filename='img/empty-camera.png') }}"
          alt=""
          loading="lazy"
          onerror="this.style.display='none'"
        />
        <p class="pv-empty-title">Camera device not found</p>
        <p class="pv-empty-subtitle">Return to the DLNA Media list to pick an installed camera.</p>
        <div class="pv-empty-actions">
          <a href="{{ url_for('camera_admin.dlna_media_list') }}" class="pv-button">Back to DLNA Media</a>
        </div>
      </div>
    {% else %}
      <form method="post" class="pv-form">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}" />

        <div class="pv-card">
          <h2>{{ device.name }}</h2>
          <p class="pv-card-subtitle">
            Configure whether this camera should be exposed as a near-live DLNA media item.
          </p>

          <div class="pv-field-group">
            <label>
              <input
                type="checkbox"
                name="is_enabled"
                value="1"
                {% if form.is_enabled %}checked{% endif %}
              />
              Enable DLNA media for this camera
            </label>
          </div>

          <div class="pv-field-group">
            <label for="title">DLNA title</label>
            <input
              id="title"
              name="title"
              type="text"
              value="{{ form.title }}"
            />
            <p class="pv-card-subtitle">
              Optional. Defaults to the camera name if left blank.
            </p>
          </div>

          <button type="submit" class="pv-button-primary">
            Save
          </button>
          <a href="{{ url_for('camera_admin.dlna_media_list') }}" class="pv-button-secondary pv-ml-2">
            Cancel
          </a>
        </div>
      </form>
    {% endif %}
      </div>
    </div>
  </section>
{% endblock %}
