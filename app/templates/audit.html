{% extends 'base.html' %}

{% block title %}Audit Log Â· PentaVision{% endblock %}

{% block content %}
  <section class="pv-section">
    <h1>Audit log</h1>
    {% include 'admin/_nav.html' %}
    <p class="pv-card-subtitle" style="margin-bottom: 1rem;">
      Recent security and authentication events recorded in the user database.
      This is a simple built-in viewer; integrate with your central logging stack
      for long-term retention and alerting.
    </p>

    {% if events %}
      <div class="pv-table-wrap">
        <table class="pv-table">
          <thead>
            <tr>
              <th>When ({{ current_timezone }})</th>
              <th>User ID</th>
              <th>Event</th>
              <th>IP</th>
              <th>Details</th>
            </tr>
          </thead>
          <tbody>
            {% for e in events %}
              <tr>
                <td>{{ e.when|local_dt }}</td>
                <td>{{ e.user_id if e.user_id is not none else '' }}</td>
                <td>{{ e.event_type }}</td>
                <td>{{ e.ip or '' }}</td>
                <td style="font-size: 0.85rem; color: #9ca3af; max-width: 420px; white-space: pre-wrap;">
                  {{ e.details or '' }}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p style="font-size: 0.9rem; color: #9ca3af;">
        No audit events found. This may mean the user database is not configured
        or that no relevant actions have occurred yet.
      </p>
    {% endif %}
  </section>
{% endblock %}
