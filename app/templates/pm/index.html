{% extends 'base.html' %}

{% block title %}Properties Â· PentaVision{% endblock %}

{% block content %}
  <section class="pv-section">
    <div class="pv-card">
      <div class="pv-card-header">
        <div>
          <h1 style="margin-bottom: 0.25rem;">Properties</h1>
          <p class="pv-card-subtitle">Manage the properties you have access to.</p>
        </div>
      </div>

      {% if properties and properties|length %}
        <div style="overflow-x: auto;">
          <table class="pv-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Timezone</th>
                <th></th>
              </tr>
            </thead>
            <tbody>
              {% for p in properties %}
                <tr>
                  <td style="font-weight: 800;">{{ p.name }}</td>
                  <td>{{ p.timezone or '' }}</td>
                  <td style="white-space: nowrap;">
                    {% if is_system_admin or is_property_admin %}
                      {% if active_admin_property and active_admin_property.id == p.id %}
                        <span class="pv-badge">Active</span>
                      {% else %}
                        <form
                          method="post"
                          action="{{ url_for('pm.pm_property_enter', property_id=p.id) }}"
                          style="display: inline;"
                        >
                          <input type="hidden" name="csrf_token" value="{{ global_csrf_token }}" />
                          <button type="submit" class="pv-button pv-button-small pv-button-primary">
                            Enter
                          </button>
                        </form>
                      {% endif %}
                    {% endif %}
                    <a class="pv-link-muted" href="{{ url_for('pm.property_users', property_id=p.id) }}">Users</a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div style="color:#9ca3af; font-size: 0.95rem;">No properties assigned.</div>
      {% endif %}
    </div>
  </section>
{% endblock %}
